import{a as Xe}from"./chunk-ZOT6WSBW.js";import{a as He,b as Ke}from"./chunk-PIMCV4RT.js";import{a as T,c as ze}from"./chunk-SW67MXF2.js";import{a as We,b as Ae,c as je,d as Ge,f as Ue}from"./chunk-3NA6AZ5F.js";import{a as Oe,b as Te,c as Be}from"./chunk-7COMX4PU.js";import{E as O,I as Pe,J as Ze,K as ke,a as Le,b as Q,l as _e,o as Ie,z as Ne}from"./chunk-DWZJEK5H.js";import{E as Re,L as xe,Oc as I,V as ve,Vc as E,W as D,Y as Me,Z as Ce,_ as L,a as ye,ba as Se,ca as Ee,cc as De,da as J,dc as Fe,ec as j,s as k,tb as Ve,u as be,v as b,za as _}from"./chunk-IV3CZHWS.js";import{D as pe,F as fe,v as ge,z as q}from"./chunk-L76X3E7P.js";import{B as de,F as A,H as me,J as he,O as we,c as le,j as ue,o as ce}from"./chunk-WEL5MCWD.js";import{Aa as p,Ba as se,P as ae,S as d,Sb as s,Tb as i,Wb as l,_ as h,ca as ie,fa as w,kb as f,lb as y,ra as g}from"./chunk-DTKK3HU7.js";import{a as V,b as ne}from"./chunk-TWZW5B45.js";function $e(u,t){let r=u.viewState.projection,o=t.getSource().getWrapX()&&r.canWrapX(),n=r.getExtent(),a=u.extent,c=o?A(n):null,m=o?Math.ceil((a[2]-n[2])/c)+1:1;return[o?Math.floor((a[0]-n[0])/c):0,m,c]}var N=ne(V({},_e),{RENDER_EXTENT:"u_renderExtent",PATTERN_ORIGIN:"u_patternOrigin",GLOBAL_ALPHA:"u_globalAlpha"}),Y=class extends Ie{constructor(t,r){let e={[N.RENDER_EXTENT]:[0,0,0,0],[N.PATTERN_ORIGIN]:[0,0],[N.GLOBAL_ALPHA]:1};super(t,{uniforms:e,postProcesses:r.postProcesses}),this.hitDetectionEnabled_=!r.disableHitDetection,this.hitRenderTarget_,this.sourceRevision_=-1,this.previousExtent_=ue(),this.currentTransform_=D(),this.tmpCoords_=[0,0],this.tmpTransform_=D(),this.tmpMat4_=Le(),this.currentFrameStateTransform_=D(),this.styleVariables_={},this.style_=[],this.styleRenderer_=null,this.buffers_=null,this.applyOptions_(r),this.batch_=new Ae,this.initialFeaturesAdded_=!1,this.sourceListenKeys_=null}addInitialFeatures_(t){let r=this.getLayer().getSource(),e=q(),o;e&&(o=ge(e,t.viewState.projection)),this.batch_.addFeatures(r.getFeatures(),o),this.sourceListenKeys_=[k(r,T.ADDFEATURE,this.handleSourceFeatureAdded_.bind(this,o)),k(r,T.CHANGEFEATURE,this.handleSourceFeatureChanged_.bind(this,o),this),k(r,T.REMOVEFEATURE,this.handleSourceFeatureDelete_,this),k(r,T.CLEAR,this.handleSourceFeatureClear_,this)]}applyOptions_(t){this.styleVariables_=t.variables,this.style_=t.style}createRenderers_(){this.buffers_=null,this.styleRenderer_=new Ge(this.style_,this.styleVariables_,this.helper,this.hitDetectionEnabled_)}reset(t){this.applyOptions_(t),this.helper&&this.createRenderers_(),super.reset(t)}afterHelperCreated(){this.styleRenderer_?this.styleRenderer_.setHelper(this.helper,this.buffers_):this.createRenderers_(),this.hitDetectionEnabled_&&(this.hitRenderTarget_=new Ue(this.helper))}handleSourceFeatureAdded_(t,r){let e=r.feature;this.batch_.addFeature(e,t)}handleSourceFeatureChanged_(t,r){let e=r.feature;this.batch_.changeFeature(e,t)}handleSourceFeatureDelete_(t){let r=t.feature;this.batch_.removeFeature(r)}handleSourceFeatureClear_(){this.batch_.clear()}applyUniforms_(t){Ce(this.tmpTransform_,this.currentFrameStateTransform_),Me(this.tmpTransform_,t),this.helper.setUniformMatrixValue(N.PROJECTION_MATRIX,Q(this.tmpMat4_,this.tmpTransform_)),J(this.tmpTransform_,this.tmpTransform_),this.helper.setUniformMatrixValue(N.SCREEN_TO_WORLD_MATRIX,Q(this.tmpMat4_,this.tmpTransform_)),this.tmpCoords_[0]=0,this.tmpCoords_[1]=0,J(this.tmpTransform_,t),L(this.tmpTransform_,this.tmpCoords_),this.helper.setUniformFloatVec2(N.PATTERN_ORIGIN,this.tmpCoords_)}renderFrame(t){let r=this.helper.getGL();this.preRender(r,t);let[e,o,n]=$e(t,this.getLayer());this.helper.prepareDraw(t),this.renderWorlds(t,!1,e,o,n),this.helper.finalizeDraw(t,this.dispatchPreComposeEvent,this.dispatchPostComposeEvent);let a=this.helper.getCanvas();return this.hitDetectionEnabled_&&(this.renderWorlds(t,!0,e,o,n),this.hitRenderTarget_.clearCachedData()),this.postRender(r,t),a}prepareFrameInternal(t){this.initialFeaturesAdded_||(this.addInitialFeatures_(t),this.initialFeaturesAdded_=!0);let r=this.getLayer(),e=r.getSource(),o=t.viewState,n=!t.viewHints[_.ANIMATING]&&!t.viewHints[_.INTERACTING],a=!ce(this.previousExtent_,t.extent),c=this.sourceRevision_<e.getRevision();if(c&&(this.sourceRevision_=e.getRevision()),n&&(a||c)){let m=o.projection,R=o.resolution,C=r instanceof I?r.getRenderBuffer():0,S=le(t.extent,C*R),v=q();v?e.loadFeatures(pe(S,v),fe(R,m),v):e.loadFeatures(S,R,m),this.ready=!1;let x=this.helper.makeProjectionTransform(t,D());this.styleRenderer_.generateBuffers(this.batch_,x).then(W=>{this.buffers_&&this.disposeBuffers(this.buffers_),this.buffers_=W,this.ready=!0,this.getLayer().changed()}),this.previousExtent_=t.extent.slice()}return!0}renderWorlds(t,r,e,o,n){let a=e;r&&(this.hitRenderTarget_.setSize([Math.floor(t.size[0]/2),Math.floor(t.size[1]/2)]),this.helper.prepareDrawToRenderTarget(t,this.hitRenderTarget_,!0));do this.helper.makeProjectionTransform(t,this.currentFrameStateTransform_),Se(this.currentFrameStateTransform_,a*n,0),this.buffers_&&this.styleRenderer_.render(this.buffers_,t,()=>{this.applyUniforms_(this.buffers_.invertVerticesTransform),this.helper.applyHitDetectionUniform(r)});while(++a<o)}forEachFeatureAtCoordinate(t,r,e,o,n){if(ve(this.hitDetectionEnabled_,"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has been disabled using the `disableHitDetection: true` option."),!this.styleRenderer_||!this.hitDetectionEnabled_)return;let a=L(r.coordinateToPixelTransform,t.slice()),c=this.hitRenderTarget_.readPixel(a[0]/2,a[1]/2),m=[c[0]/255,c[1]/255,c[2]/255,c[3]/255],R=je(m),C=this.batch_.getFeatureFromRef(R);if(C)return o(C,this.getLayer(),null)}disposeBuffers(t){let r=e=>{for(let o of e)o&&this.helper.deleteBuffer(o)};t.pointBuffers&&r(t.pointBuffers),t.lineStringBuffers&&r(t.lineStringBuffers),t.polygonBuffers&&r(t.polygonBuffers)}disposeInternal(){this.buffers_&&this.disposeBuffers(this.buffers_),this.sourceListenKeys_&&(this.sourceListenKeys_.forEach(function(t){be(t)}),this.sourceListenKeys_=null),super.disposeInternal()}renderDeclutter(){}},G=Y;var M={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"},nt=["#00f","#0ff","#0f0","#ff0","#f00"],ee=class extends I{constructor(t){t=t||{};let r=Object.assign({},t);delete r.gradient,delete r.radius,delete r.blur,delete r.weight,super(r),this.filter_=t.filter??!0,this.styleVariables_=t.variables||{},this.gradient_=null,this.addChangeListener(M.GRADIENT,this.handleGradientChanged_),this.setGradient(t.gradient?t.gradient:nt),this.setBlur(t.blur!==void 0?t.blur:15),this.setRadius(t.radius!==void 0?t.radius:8);let e=t.weight?t.weight:"weight";this.weight_=e,this.setRenderOrder(null)}getBlur(){return this.get(M.BLUR)}getGradient(){return this.get(M.GRADIENT)}getRadius(){return this.get(M.RADIUS)}handleGradientChanged_(){this.gradient_=at(this.getGradient())}setBlur(t){let r=this.get(M.BLUR);if(this.set(M.BLUR,t),typeof t=="number"&&typeof r=="number"){this.changed();return}this.clearRenderer()}setGradient(t){this.set(M.GRADIENT,t)}setRadius(t){let r=this.get(M.RADIUS);if(this.set(M.RADIUS,t),typeof t=="number"&&typeof r=="number"){this.changed();return}this.clearRenderer()}setFilter(t){this.filter_=t,this.changed(),this.clearRenderer()}setWeight(t){this.weight_=t,this.changed(),this.clearRenderer()}createRenderer(){let t=new We,r=Ne(),e=O(r,this.filter_,Fe),o=O(r,this.getRadius(),j),n=O(r,this.getBlur(),j),a={};typeof this.getBlur()=="number"&&(n="a_blur",a.a_blur=()=>this.getBlur(),t.addUniform("a_blur","float")),typeof this.getRadius()=="number"&&(o="a_radius",a.a_radius=()=>this.getRadius(),t.addUniform("a_radius","float"));let c={},m=null;if(typeof this.weight_=="string"||typeof this.weight_=="function"){let S=typeof this.weight_=="string"?v=>v.get(this.weight_):this.weight_;c.prop_weight={size:1,callback:v=>{let x=S(v);return x!==void 0?we(x,0,1):1}},m="a_prop_weight",t.addAttribute("a_prop_weight","float")}else{let S=["clamp",this.weight_,0,1];m=O(r,S,j)}t.addFragmentShaderFunction(`float getBlurSlope() {
  float blur = max(1., ${n});
  float radius = ${o};
  return radius / blur;
}`).setSymbolSizeExpression(`vec2(${o} + ${n}) * 2.`).setSymbolColorExpression(`vec4(smoothstep(0., 1., (1. - length(coordsPx * 2. / v_quadSizePx)) * getBlurSlope()) * ${m})`).setStrokeColorExpression(`vec4(smoothstep(0., 1., (1. - length(currentRadiusPx * 2. / v_width)) * getBlurSlope()) * ${m})`).setStrokeWidthExpression(`(${o} + ${n}) * 2.`).setFillColorExpression(`vec4(${m})`).setFragmentDiscardExpression(`!${e}`),Pe(t,r);let R=ke(r),C=Ze(r,this.styleVariables_);return new G(this,{className:this.getClassName(),variables:this.styleVariables_,style:{builder:t,attributes:V(V({},R),c),uniforms:V(V({},C),a)},disableHitDetection:!1,postProcesses:[{fragmentShader:`
            precision mediump float;

            uniform sampler2D u_image;
            uniform sampler2D u_gradientTexture;
            uniform float u_opacity;

            varying vec2 v_texCoord;

            void main() {
              vec4 color = texture2D(u_image, v_texCoord);
              gl_FragColor.a = color.a * u_opacity;
              gl_FragColor.rgb = texture2D(u_gradientTexture, vec2(0.5, color.a)).rgb;
              gl_FragColor.rgb *= gl_FragColor.a;
            }`,uniforms:{u_gradientTexture:()=>this.gradient_,u_opacity:()=>this.getOpacity()}}]})}updateStyleVariables(t){Object.assign(this.styleVariables_,t),this.changed()}renderDeclutter(){}};function at(u){let e=Re(1,256),o=e.createLinearGradient(0,0,1,256),n=1/(u.length-1);for(let a=0,c=u.length;a<c;++a)o.addColorStop(a*n,u[a]);return e.fillStyle=o,e.fillRect(0,0,1,256),e.canvas}var qe=ee;var it=["*"],U=class u{wolClassName=i();wolOpacity=l();wolVisible=l();wolExtent=l();wolZIndex=l();wolMinResolution=l();wolMaxResolution=l();wolMinZoom=l();wolMaxZoom=l();wolGradient=l();wolRadius=l();wolBlur=l();wolWeight=i();wolFilter=i();wolVariables=i();wolSource=l();wolProperties=i();wolChange=s();wolError=s();wolPostRender=s();wolPreRender=s();wolPropertyChange=s();wolSourceReady=s();instance;constructor(){let t=d(h),r=E("Heatmap"),e={};g(()=>{let o=new qe({className:this.wolClassName(),opacity:this.wolOpacity(),visible:this.wolVisible(),extent:this.wolExtent(),zIndex:this.wolZIndex(),minResolution:this.wolMinResolution(),maxResolution:this.wolMaxResolution(),minZoom:this.wolMinZoom(),maxZoom:this.wolMaxZoom(),gradient:this.wolGradient(),radius:this.wolRadius(),blur:this.wolBlur(),weight:this.wolWeight(),filter:this.wolFilter(),variables:this.wolVariables(),source:this.wolSource(),properties:this.wolProperties()});e.change=o.on("change",n=>this.wolChange.emit(n)),e["change:blur"]=o.on("change:blur",()=>this.wolBlur.set(o.getBlur())),e["change:extent"]=o.on("change:extent",()=>this.wolExtent.set(o.getExtent())),e["change:gradient"]=o.on("change:gradient",()=>this.wolGradient.set(o.getGradient())),e["change:maxResolution"]=o.on("change:maxResolution",()=>this.wolMaxResolution.set(o.getMaxResolution())),e["change:maxZoom"]=o.on("change:maxZoom",()=>this.wolMaxZoom.set(o.getMaxZoom())),e["change:minResolution"]=o.on("change:minResolution",()=>this.wolMinResolution.set(o.getMinResolution())),e["change:minZoom"]=o.on("change:minZoom",()=>this.wolMinZoom.set(o.getMinZoom())),e["change:opacity"]=o.on("change:opacity",()=>this.wolOpacity.set(o.getOpacity())),e["change:source"]=o.on("change:source",()=>this.wolSource.set(o.getSource()??void 0)),e["change:radius"]=o.on("change:radius",()=>this.wolRadius.set(o.getRadius())),e["change:visible"]=o.on("change:visible",()=>this.wolVisible.set(o.getVisible())),e["change:zIndex"]=o.on("change:zIndex",()=>this.wolZIndex.set(o.getZIndex())),e.error=o.on("error",n=>this.wolError.emit(n)),e.postrender=o.on("postrender",n=>this.wolPostRender.emit(n)),e.prerender=o.on("prerender",n=>this.wolPreRender.emit(n)),e.propertychange=o.on("propertychange",n=>this.wolPropertyChange.emit(n)),e.sourceready=o.on("sourceready",n=>this.wolSourceReady.emit(n)),Promise.resolve().then(()=>{r.addLayer(o)}),this.instance=o}),t.onDestroy(()=>{b(Object.values(e)),this.instance&&(r.removeLayer(this.instance),this.instance=void 0)})}ngOnChanges(t){if(this.instance)for(let[r,e]of Object.entries(t))switch(r){case"wolBlur":this.instance.setBlur(e.currentValue);break;case"wolExtent":this.instance.setExtent(e.currentValue);break;case"wolFilter":this.instance.setFilter(e.currentValue);break;case"wolGradient":this.instance.setGradient(e.currentValue);break;case"wolMaxResolution":this.instance.setMaxResolution(e.currentValue);break;case"wolMaxZoom":this.instance.setMaxZoom(e.currentValue);break;case"wolMinResolution":this.instance.setMinResolution(e.currentValue);break;case"wolMinZoom":this.instance.setMinZoom(e.currentValue);break;case"wolOpacity":this.instance.setOpacity(e.currentValue);break;case"wolProperties":this.instance.setProperties(e.currentValue??{});break;case"wolRadius":this.instance.setRadius(e.currentValue);break;case"wolSource":this.instance.setSource(e.currentValue??null);break;case"wolVisible":this.instance.setVisible(e.currentValue);break;case"wolWeight":this.instance.setWeight(e.currentValue);break;case"wolZIndex":this.instance.setZIndex(e.currentValue);break;case"wolVariables":this.instance.updateStyleVariables(e.currentValue);break}}getInstance(){return this.instance}static \u0275fac=function(r){return new(r||u)};static \u0275cmp=p({type:u,selectors:[["wol-heatmap-layer"]],inputs:{wolClassName:[1,"wolClassName"],wolOpacity:[1,"wolOpacity"],wolVisible:[1,"wolVisible"],wolExtent:[1,"wolExtent"],wolZIndex:[1,"wolZIndex"],wolMinResolution:[1,"wolMinResolution"],wolMaxResolution:[1,"wolMaxResolution"],wolMinZoom:[1,"wolMinZoom"],wolMaxZoom:[1,"wolMaxZoom"],wolGradient:[1,"wolGradient"],wolRadius:[1,"wolRadius"],wolBlur:[1,"wolBlur"],wolWeight:[1,"wolWeight"],wolFilter:[1,"wolFilter"],wolVariables:[1,"wolVariables"],wolSource:[1,"wolSource"],wolProperties:[1,"wolProperties"]},outputs:{wolOpacity:"wolOpacityChange",wolVisible:"wolVisibleChange",wolExtent:"wolExtentChange",wolZIndex:"wolZIndexChange",wolMinResolution:"wolMinResolutionChange",wolMaxResolution:"wolMaxResolutionChange",wolMinZoom:"wolMinZoomChange",wolMaxZoom:"wolMaxZoomChange",wolGradient:"wolGradientChange",wolRadius:"wolRadiusChange",wolBlur:"wolBlurChange",wolSource:"wolSourceChange",wolChange:"wolChange",wolError:"wolError",wolPostRender:"wolPostRender",wolPreRender:"wolPreRender",wolPropertyChange:"wolPropertyChange",wolSourceReady:"wolSourceReady"},exportAs:["wolHeatmapLayer"],features:[w],ngContentSelectors:it,decls:1,vars:0,template:function(r,e){r&1&&(f(),y(0))},encapsulation:2,changeDetection:0})};var st=["*"],Z=class u{wolClassName=i();wolOpacity=l();wolVisible=l();wolExtent=l();wolZIndex=l();wolMinResolution=l();wolMaxResolution=l();wolMinZoom=l();wolMaxZoom=l();wolRenderOrder=i();wolRenderBuffer=i();wolSource=l();wolMap=i();wolDeclutter=i();wolStyle=i();wolBackground=i();wolUpdateWhileAnimating=i();wolUpdateWhileInteracting=i();wolProperties=i();wolChange=s();wolError=s();wolPostRender=s();wolPreRender=s();wolPropertyChange=s();wolSourceReady=s();instance;constructor(){let t=d(h),r=E("VectorLayer"),e={};g(()=>{let o=new Ke({className:this.wolClassName(),opacity:this.wolOpacity(),visible:this.wolVisible(),extent:this.wolExtent(),zIndex:this.wolZIndex(),minResolution:this.wolMinResolution(),maxResolution:this.wolMaxResolution(),minZoom:this.wolMinZoom(),maxZoom:this.wolMaxZoom(),renderOrder:this.wolRenderOrder(),renderBuffer:this.wolRenderBuffer(),source:this.wolSource(),map:this.wolMap(),declutter:this.wolDeclutter(),style:this.wolStyle(),background:this.wolBackground(),updateWhileAnimating:this.wolUpdateWhileAnimating(),updateWhileInteracting:this.wolUpdateWhileInteracting(),properties:this.wolProperties()});e.change=o.on("change",n=>this.wolChange.emit(n)),e["change:extent"]=o.on("change:extent",()=>this.wolExtent.set(o.getExtent())),e["change:maxResolution"]=o.on("change:maxResolution",()=>this.wolMaxResolution.set(o.getMaxResolution())),e["change:minResolution"]=o.on("change:minResolution",()=>this.wolMinResolution.set(o.getMinResolution())),e["change:maxZoom"]=o.on("change:maxZoom",()=>this.wolMaxZoom.set(o.getMaxZoom())),e["change:minZoom"]=o.on("change:minZoom",()=>this.wolMinZoom.set(o.getMinZoom())),e["change:opacity"]=o.on("change:opacity",()=>this.wolOpacity.set(o.getOpacity())),e["change:source"]=o.on("change:source",()=>this.wolSource.set(o.getSource()??void 0)),e["change:visible"]=o.on("change:visible",()=>this.wolVisible.set(o.getVisible())),e["change:zIndex"]=o.on("change:zIndex",()=>this.wolZIndex.set(o.getZIndex()??0)),e.error=o.on("error",n=>this.wolError.emit(n)),e.postrender=o.on("postrender",n=>this.wolPostRender.emit(n)),e.prerender=o.on("prerender",n=>this.wolPreRender.emit(n)),e.propertychange=o.on("propertychange",n=>this.wolPropertyChange.emit(n)),e.sourceready=o.on("sourceready",n=>this.wolSourceReady.emit(n)),Promise.resolve().then(()=>{r.addLayer(o)}),this.instance=o}),t.onDestroy(()=>{b(Object.values(e)),this.instance&&(r.removeLayer(this.instance),this.instance=void 0)})}ngOnChanges(t){if(this.instance)for(let[r,e]of Object.entries(t))switch(r){case"wolDeclutter":this.instance.setDeclutter(e.currentValue);break;case"wolExtent":this.instance.setExtent(e.currentValue);break;case"wolMap":this.instance.setMap(e.currentValue);break;case"wolMaxResolution":this.instance.setMaxResolution(e.currentValue);break;case"wolMinResolution":this.instance.setMinResolution(e.currentValue);break;case"wolMaxZoom":this.instance.setMaxZoom(e.currentValue);break;case"wolMinZoom":this.instance.setMinZoom(e.currentValue);break;case"wolOpacity":this.instance.setOpacity(e.currentValue);break;case"wolProperties":this.instance.setProperties(e.currentValue);break;case"wolSource":this.instance.setSource(e.currentValue);break;case"wolStyle":this.instance.setStyle(e.currentValue);break;case"wolVisible":this.instance.setVisible(e.currentValue);break;case"wolZIndex":this.instance.setZIndex(e.currentValue);break}}getInstance(){return this.instance}static \u0275fac=function(r){return new(r||u)};static \u0275cmp=p({type:u,selectors:[["wol-vector-layer"]],inputs:{wolClassName:[1,"wolClassName"],wolOpacity:[1,"wolOpacity"],wolVisible:[1,"wolVisible"],wolExtent:[1,"wolExtent"],wolZIndex:[1,"wolZIndex"],wolMinResolution:[1,"wolMinResolution"],wolMaxResolution:[1,"wolMaxResolution"],wolMinZoom:[1,"wolMinZoom"],wolMaxZoom:[1,"wolMaxZoom"],wolRenderOrder:[1,"wolRenderOrder"],wolRenderBuffer:[1,"wolRenderBuffer"],wolSource:[1,"wolSource"],wolMap:[1,"wolMap"],wolDeclutter:[1,"wolDeclutter"],wolStyle:[1,"wolStyle"],wolBackground:[1,"wolBackground"],wolUpdateWhileAnimating:[1,"wolUpdateWhileAnimating"],wolUpdateWhileInteracting:[1,"wolUpdateWhileInteracting"],wolProperties:[1,"wolProperties"]},outputs:{wolOpacity:"wolOpacityChange",wolVisible:"wolVisibleChange",wolExtent:"wolExtentChange",wolZIndex:"wolZIndexChange",wolMinResolution:"wolMinResolutionChange",wolMaxResolution:"wolMaxResolutionChange",wolMinZoom:"wolMinZoomChange",wolMaxZoom:"wolMaxZoomChange",wolSource:"wolSourceChange",wolChange:"wolChange",wolError:"wolError",wolPostRender:"wolPostRender",wolPreRender:"wolPreRender",wolPropertyChange:"wolPropertyChange",wolSourceReady:"wolSourceReady"},exportAs:["wolVectorLayer"],features:[w],ngContentSelectors:st,decls:1,vars:0,template:function(r,e){r&1&&(f(),y(0))},encapsulation:2,changeDetection:0})};var te=class extends Te{constructor(t){super(t),this.vectorRenderer_=new He(t),this.layerImageRatio_=t.getImageRatio(),this.coordinateToVectorPixelTransform_=D(),this.renderedPixelToCoordinateTransform_=null}disposeInternal(){this.vectorRenderer_.dispose(),super.disposeInternal()}getFeatures(t){if(!this.vectorRenderer_)return Promise.resolve([]);let r=L(this.coordinateToVectorPixelTransform_,L(this.renderedPixelToCoordinateTransform_,t.slice()));return this.vectorRenderer_.getFeatures(r)}handleFontsChanged(){this.vectorRenderer_.handleFontsChanged()}prepareFrame(t){let r=t.pixelRatio,e=t.viewState,o=e.resolution,n=t.viewHints,a=this.vectorRenderer_,c=t.extent;this.layerImageRatio_!==1&&(c=c.slice(0),he(c,this.layerImageRatio_));let m=A(c)/o,R=de(c)/o;if(!n[_.ANIMATING]&&!n[_.INTERACTING]&&!me(c)){a.useContainer(null,null);let C=a.context,S=t.layerStatesArray[t.layerIndex],v=Object.assign({},S,{opacity:1}),x=Object.assign({},t,{extent:c,size:[m,R],viewState:Object.assign({},t.viewState,{rotation:0}),layerStatesArray:[v],layerIndex:0,declutter:null}),W=this.getLayer().getDeclutter();W&&(x.declutter={[W]:new De(9)});let F=new Oe(c,o,r,C.canvas,function(X){a.prepareFrame(x)&&a.replayGroupChanged&&(a.clipping=!1,a.renderFrame(x,null),a.renderDeclutter(x),a.renderDeferred(x),X())});F.addEventListener(ye.CHANGE,()=>{if(F.getState()!==xe.LOADED)return;this.image=F;let X=F.getPixelRatio(),$=Be(F.getResolution())*r/X;this.renderedResolution=$,this.coordinateToVectorPixelTransform_=Ee(this.coordinateToVectorPixelTransform_,m/2,R/2,1/$,-1/$,0,-e.center[0],-e.center[1])}),F.load()}return this.image&&(this.renderedPixelToCoordinateTransform_=t.pixelToCoordinateTransform.slice()),!this.getLayer().getSource()?.loading&&!!this.image}preRender(){}postRender(){}renderDeclutter(){}forEachFeatureAtCoordinate(t,r,e,o,n){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(t,r,e,o,n):super.forEachFeatureAtCoordinate(t,r,e,o,n)}},Je=te;var oe=class extends I{constructor(t){t=t||{};let r=Object.assign({},t);delete r.imageRatio,super(r),this.imageRatio_=t.imageRatio!==void 0?t.imageRatio:1}getImageRatio(){return this.imageRatio_}createRenderer(){return new Je(this)}},Qe=oe;var lt=["*"],H=class u{wolClassName=i();wolOpacity=l();wolVisible=l();wolExtent=l();wolZIndex=l();wolMinResolution=l();wolMaxResolution=l();wolMinZoom=l();wolMaxZoom=l();wolRenderOrder=i();wolRenderBuffer=i();wolSource=l();wolMap=i();wolDeclutter=i();wolStyle=i();wolBackground=i();wolImageRatio=i();wolProperties=i();wolChange=s();wolError=s();wolPostRender=s();wolPreRender=s();wolPropertyChange=s();wolSourceReady=s();instance;constructor(){let t=d(h),r=E("VectorImageLayer"),e={};g(()=>{let o=new Qe({className:this.wolClassName(),opacity:this.wolOpacity(),visible:this.wolVisible(),extent:this.wolExtent(),zIndex:this.wolZIndex(),minResolution:this.wolMinResolution(),maxResolution:this.wolMaxResolution(),minZoom:this.wolMinZoom(),maxZoom:this.wolMaxZoom(),renderOrder:this.wolRenderOrder(),renderBuffer:this.wolRenderBuffer(),source:this.wolSource(),map:this.wolMap(),declutter:this.wolDeclutter(),style:this.wolStyle(),background:this.wolBackground(),imageRatio:this.wolImageRatio(),properties:this.wolProperties()});e.change=o.on("change",n=>this.wolChange.emit(n)),e["change:extent"]=o.on("change:extent",()=>this.wolExtent.set(o.getExtent())),e["change:maxResolution"]=o.on("change:maxResolution",()=>this.wolMaxResolution.set(o.getMaxResolution())),e["change:maxZoom"]=o.on("change:maxZoom",()=>this.wolMaxZoom.set(o.getMaxZoom())),e["change:minResolution"]=o.on("change:minResolution",()=>this.wolMinResolution.set(o.getMinResolution())),e["change:minZoom"]=o.on("change:minZoom",()=>this.wolMinZoom.set(o.getMinZoom())),e["change:opacity"]=o.on("change:opacity",()=>this.wolOpacity.set(o.getOpacity())),e["change:source"]=o.on("change:source",()=>this.wolSource.set(o.getSource()??void 0)),e["change:visible"]=o.on("change:visible",()=>this.wolVisible.set(o.getVisible())),e["change:zIndex"]=o.on("change:zIndex",()=>this.wolZIndex.set(o.getZIndex()??0)),e.error=o.on("error",n=>this.wolError.emit(n)),e.postrender=o.on("postrender",n=>this.wolPostRender.emit(n)),e.prerender=o.on("prerender",n=>this.wolPreRender.emit(n)),e.propertychange=o.on("propertychange",n=>this.wolPropertyChange.emit(n)),e.sourceready=o.on("sourceready",n=>this.wolSourceReady.emit(n)),Promise.resolve().then(()=>{r.addLayer(o)}),this.instance=o}),t.onDestroy(()=>{b(Object.values(e)),this.instance&&(r.removeLayer(this.instance),this.instance=void 0)})}ngOnChanges(t){if(this.instance)for(let[r,e]of Object.entries(t))switch(r){case"wolDeclutter":this.instance.setDeclutter(e.currentValue);break;case"wolExtent":this.instance.setExtent(e.currentValue);break;case"wolMap":this.instance.setMap(e.currentValue);break;case"wolMaxResolution":this.instance.setMaxResolution(e.currentValue);break;case"wolMaxZoom":this.instance.setMaxZoom(e.currentValue);break;case"wolMinResolution":this.instance.setMinResolution(e.currentValue);break;case"wolMinZoom":this.instance.setMinZoom(e.currentValue);break;case"wolOpacity":this.instance.setOpacity(e.currentValue);break;case"wolProperties":this.instance.setProperties(e.currentValue);break;case"wolSource":this.instance.setSource(e.currentValue);break;case"wolStyle":this.instance.setStyle(e.currentValue);break;case"wolVisible":this.instance.setVisible(e.currentValue);break;case"wolZIndex":this.instance.setZIndex(e.currentValue);break}}getInstance(){return this.instance}static \u0275fac=function(r){return new(r||u)};static \u0275cmp=p({type:u,selectors:[["wol-vector-image-layer"]],inputs:{wolClassName:[1,"wolClassName"],wolOpacity:[1,"wolOpacity"],wolVisible:[1,"wolVisible"],wolExtent:[1,"wolExtent"],wolZIndex:[1,"wolZIndex"],wolMinResolution:[1,"wolMinResolution"],wolMaxResolution:[1,"wolMaxResolution"],wolMinZoom:[1,"wolMinZoom"],wolMaxZoom:[1,"wolMaxZoom"],wolRenderOrder:[1,"wolRenderOrder"],wolRenderBuffer:[1,"wolRenderBuffer"],wolSource:[1,"wolSource"],wolMap:[1,"wolMap"],wolDeclutter:[1,"wolDeclutter"],wolStyle:[1,"wolStyle"],wolBackground:[1,"wolBackground"],wolImageRatio:[1,"wolImageRatio"],wolProperties:[1,"wolProperties"]},outputs:{wolOpacity:"wolOpacityChange",wolVisible:"wolVisibleChange",wolExtent:"wolExtentChange",wolZIndex:"wolZIndexChange",wolMinResolution:"wolMinResolutionChange",wolMaxResolution:"wolMaxResolutionChange",wolMinZoom:"wolMinZoomChange",wolMaxZoom:"wolMaxZoomChange",wolSource:"wolSourceChange",wolChange:"wolChange",wolError:"wolError",wolPostRender:"wolPostRender",wolPreRender:"wolPreRender",wolPropertyChange:"wolPropertyChange",wolSourceReady:"wolSourceReady"},exportAs:["wolVectorImageLayer"],features:[w],ngContentSelectors:lt,decls:1,vars:0,template:function(r,e){r&1&&(f(),y(0))},encapsulation:2,changeDetection:0})};var re=class extends Ve{constructor(t){let r=Object.assign({},t);super(r),this.styleVariables_=t.variables||{},this.style_=t.style,this.hitDetectionDisabled_=!!t.disableHitDetection}createRenderer(){return new G(this,{style:this.style_,variables:this.styleVariables_,disableHitDetection:this.hitDetectionDisabled_})}updateStyleVariables(t){Object.assign(this.styleVariables_,t),this.changed()}setStyle(t){this.style_=t,this.clearRenderer(),this.changed()}},Ye=re;var ut=["*"],K=class u{wolClassName=i();wolOpacity=l();wolVisible=l();wolExtent=l();wolZIndex=l();wolMinResolution=l();wolMaxResolution=l();wolMinZoom=l();wolMaxZoom=l();wolSource=l();wolStyle=i.required();wolVariables=i();wolBackground=i();wolDisableHitDetection=i();wolProperties=i();wolChange=s();wolError=s();wolPostRender=s();wolPreRender=s();wolPropertyChange=s();wolSourceReady=s();instance;constructor(){let t=d(h),r=E("WebGLVectorLayer"),e={};g(()=>{let o=new Ye({className:this.wolClassName(),opacity:this.wolOpacity(),visible:this.wolVisible(),extent:this.wolExtent(),zIndex:this.wolZIndex(),minResolution:this.wolMinResolution(),maxResolution:this.wolMaxResolution(),minZoom:this.wolMinZoom(),maxZoom:this.wolMaxZoom(),source:this.wolSource(),style:this.wolStyle(),variables:this.wolVariables(),background:this.wolBackground(),disableHitDetection:this.wolDisableHitDetection(),properties:this.wolProperties()});e.change=o.on("change",n=>this.wolChange.emit(n)),e["change:extent"]=o.on("change:extent",()=>this.wolExtent.set(o.getExtent())),e["change:maxResolution"]=o.on("change:maxResolution",()=>this.wolMaxResolution.set(o.getMaxResolution())),e["change:minResolution"]=o.on("change:minResolution",()=>this.wolMinResolution.set(o.getMinResolution())),e["change:maxZoom"]=o.on("change:maxZoom",()=>this.wolMaxZoom.set(o.getMaxZoom())),e["change:minZoom"]=o.on("change:minZoom",()=>this.wolMinZoom.set(o.getMinZoom())),e["change:opacity"]=o.on("change:opacity",()=>this.wolOpacity.set(o.getOpacity())),e["change:source"]=o.on("change:source",()=>this.wolSource.set(o.getSource()??void 0)),e["change:visible"]=o.on("change:visible",()=>this.wolVisible.set(o.getVisible())),e["change:zIndex"]=o.on("change:zIndex",()=>this.wolZIndex.set(o.getZIndex()??0)),e.error=o.on("error",n=>this.wolError.emit(n)),e.postrender=o.on("postrender",n=>this.wolPostRender.emit(n)),e.prerender=o.on("prerender",n=>this.wolPreRender.emit(n)),e.propertychange=o.on("propertychange",n=>this.wolPropertyChange.emit(n)),e.sourceready=o.on("sourceready",n=>this.wolSourceReady.emit(n)),Promise.resolve().then(()=>{r.addLayer(o)}),this.instance=o}),t.onDestroy(()=>{b(Object.values(e)),this.instance&&(r.removeLayer(this.instance),this.instance.dispose(),this.instance=void 0)})}ngOnChanges(t){if(this.instance)for(let[r,e]of Object.entries(t))switch(r){case"wolExtent":this.instance.setExtent(e.currentValue);break;case"wolMaxResolution":this.instance.setMaxResolution(e.currentValue);break;case"wolMinResolution":this.instance.setMinResolution(e.currentValue);break;case"wolMaxZoom":this.instance.setMaxZoom(e.currentValue);break;case"wolMinZoom":this.instance.setMinZoom(e.currentValue);break;case"wolOpacity":this.instance.setOpacity(e.currentValue);break;case"wolProperties":this.instance.setProperties(e.currentValue);break;case"wolSource":this.instance.setSource(e.currentValue);break;case"wolStyle":this.instance.setStyle(e.currentValue);break;case"wolVariables":this.instance.updateStyleVariables(e.currentValue);break;case"wolVisible":this.instance.setVisible(e.currentValue);break;case"wolZIndex":this.instance.setZIndex(e.currentValue);break}}getInstance(){return this.instance}static \u0275fac=function(r){return new(r||u)};static \u0275cmp=p({type:u,selectors:[["wol-webgl-vector-layer"]],inputs:{wolClassName:[1,"wolClassName"],wolOpacity:[1,"wolOpacity"],wolVisible:[1,"wolVisible"],wolExtent:[1,"wolExtent"],wolZIndex:[1,"wolZIndex"],wolMinResolution:[1,"wolMinResolution"],wolMaxResolution:[1,"wolMaxResolution"],wolMinZoom:[1,"wolMinZoom"],wolMaxZoom:[1,"wolMaxZoom"],wolSource:[1,"wolSource"],wolStyle:[1,"wolStyle"],wolVariables:[1,"wolVariables"],wolBackground:[1,"wolBackground"],wolDisableHitDetection:[1,"wolDisableHitDetection"],wolProperties:[1,"wolProperties"]},outputs:{wolOpacity:"wolOpacityChange",wolVisible:"wolVisibleChange",wolExtent:"wolExtentChange",wolZIndex:"wolZIndexChange",wolMinResolution:"wolMinResolutionChange",wolMaxResolution:"wolMaxResolutionChange",wolMinZoom:"wolMinZoomChange",wolMaxZoom:"wolMaxZoomChange",wolSource:"wolSourceChange",wolChange:"wolChange",wolError:"wolError",wolPostRender:"wolPostRender",wolPreRender:"wolPreRender",wolPropertyChange:"wolPropertyChange",wolSourceReady:"wolSourceReady"},exportAs:["wolWebGLVectorLayer"],features:[w],ngContentSelectors:ut,decls:1,vars:0,template:function(r,e){r&1&&(f(),y(0))},encapsulation:2,changeDetection:0})};function et(u){let r=d(Z,{host:!0,optional:!0});if(r)return{setSource:e=>(r.getInstance()?.setSource(e),()=>{r.getInstance()?.setSource(null)}),getInstance:()=>r.getInstance()};throw new Error(`No ClusterSource host found. Please wrap the ${u} component in a VectorLayer component.`)}var ct=["*"],z=class u{wolAttributions=i();wolDistance=i();wolMinDistance=i();wolGeometryFunction=i();wolCreateCluster=i();wolSource=i();wolWrapX=i();wolProperties=i();wolAddFeature=s();wolChange=s();wolChangeFeature=s();wolClear=s();wolError=s();wolFeaturesLoadEnd=s();wolFeaturesLoadError=s();wolFeaturesLoadStart=s();wolPropertyChange=s();wolRemoveFeature=s();instance;constructor(){let t=d(h),r=et("Cluster"),e={},o;g(()=>{let n=new Xe({attributions:this.wolAttributions(),distance:this.wolDistance(),minDistance:this.wolMinDistance(),geometryFunction:this.wolGeometryFunction(),createCluster:this.wolCreateCluster(),source:this.wolSource(),wrapX:this.wolWrapX()});this.wolProperties()&&n.setProperties(this.wolProperties()??{},!0),e.addfeature=n.on("addfeature",a=>{this.wolAddFeature.emit(a)}),e.change=n.on("change",a=>{this.wolChange.emit(a)}),e.changefeature=n.on("changefeature",a=>{this.wolChangeFeature.emit(a)}),e.clear=n.on("clear",a=>{this.wolClear.emit(a)}),e.error=n.on("error",a=>{this.wolError.emit(a)}),e.featuresloadend=n.on("featuresloadend",a=>{this.wolFeaturesLoadEnd.emit(a)}),e.featuresloaderror=n.on("featuresloaderror",a=>{this.wolFeaturesLoadError.emit(a)}),e.featuresloadstart=n.on("featuresloadstart",a=>{this.wolFeaturesLoadStart.emit(a)}),e.propertychange=n.on("propertychange",a=>{this.wolPropertyChange.emit(a)}),e.removefeature=n.on("removefeature",a=>{this.wolRemoveFeature.emit(a)}),Promise.resolve().then(()=>{o=r.setSource(n)}),this.instance=n}),t.onDestroy(()=>{b(Object.values(e)),o&&o(),this.instance?.setSource(null),this.instance=void 0})}ngOnChanges(t){if(this.instance)for(let[r,e]of Object.entries(t))switch(r){case"wolAttributions":this.instance.setAttributions(e.currentValue);break;case"wolDistance":this.instance.setDistance(e.currentValue);break;case"wolMinDistance":this.instance.setMinDistance(e.currentValue);break;case"wolProperties":this.instance.setProperties(e.currentValue??{});break;case"wolSource":this.instance.setSource(e.currentValue);break}}getInstance(){return this.instance}static \u0275fac=function(r){return new(r||u)};static \u0275cmp=p({type:u,selectors:[["wol-cluster-source"]],inputs:{wolAttributions:[1,"wolAttributions"],wolDistance:[1,"wolDistance"],wolMinDistance:[1,"wolMinDistance"],wolGeometryFunction:[1,"wolGeometryFunction"],wolCreateCluster:[1,"wolCreateCluster"],wolSource:[1,"wolSource"],wolWrapX:[1,"wolWrapX"],wolProperties:[1,"wolProperties"]},outputs:{wolAddFeature:"wolAddFeature",wolChange:"wolChange",wolChangeFeature:"wolChangeFeature",wolClear:"wolClear",wolError:"wolError",wolFeaturesLoadEnd:"wolFeaturesLoadEnd",wolFeaturesLoadError:"wolFeaturesLoadError",wolFeaturesLoadStart:"wolFeaturesLoadStart",wolPropertyChange:"wolPropertyChange",wolRemoveFeature:"wolRemoveFeature"},exportAs:["wolClusterSource"],features:[w],ngContentSelectors:ct,decls:1,vars:0,template:function(r,e){r&1&&(f(),y(0))},encapsulation:2,changeDetection:0})};function tt(u){let t={host:!0,optional:!0},r=d(U,t),e=d(H,t),o=d(Z,t),n=d(K,t),a=d(z,t);if(a)return{setSource:c=>(a.getInstance()?.setSource(c),()=>{a.getInstance()?.setSource(null)}),getInstance:()=>a.getInstance()};if(r)return{setSource:c=>(r.getInstance()?.setSource(c),()=>{r.getInstance()?.setSource(null)}),getInstance:()=>r.getInstance()};if(e)return{setSource:c=>(e.getInstance()?.setSource(c),()=>{e.getInstance()?.setSource(null)}),getInstance:()=>e.getInstance()};if(o)return{setSource:c=>(o.getInstance()?.setSource(c),()=>{o.getInstance()?.setSource(null)}),getInstance:()=>o.getInstance()};if(n)return{setSource:c=>(n.getInstance()?.setSource(c),()=>{n.getInstance()?.setSource(null)}),getInstance:()=>n.getInstance()};throw new Error(`No VectorSource host found. Please wrap the ${u} component in a HeatmapLayer, VectorImageLayer, VectorLayer or WebGLVectorLayer component.`)}var dt=["*"],ot=class u{wolAttributions=i();wolFeatures=i();wolFormat=i();wolLoader=i();wolOverlaps=i();wolStrategy=i();wolUrl=i();wolUseSpatialIndex=i();wolWrapX=i();wolProperties=i();wolAddFeature=s();wolChange=s();wolChangeFeature=s();wolClear=s();wolError=s();wolFeaturesLoadEnd=s();wolFeaturesLoadError=s();wolFeaturesLoadStart=s();wolPropertyChange=s();wolRemoveFeature=s();vectorSourceInstance=ie(void 0);constructor(){let t=d(h),r=tt("VectorSource"),e={},o;g(()=>{let n=new ze({attributions:this.wolAttributions(),features:this.wolFeatures(),format:this.wolFormat(),loader:this.wolLoader(),overlaps:this.wolOverlaps(),strategy:this.wolStrategy(),url:this.wolUrl(),useSpatialIndex:this.wolUseSpatialIndex(),wrapX:this.wolWrapX()});this.wolProperties()&&n.setProperties(this.wolProperties()??{},!0),e.addfeature=n.on("addfeature",a=>{this.wolAddFeature.emit(a)}),e.change=n.on("change",a=>{this.wolChange.emit(a)}),e.changefeature=n.on("changefeature",a=>{this.wolChangeFeature.emit(a)}),e.clear=n.on("clear",a=>{this.wolClear.emit(a)}),e.error=n.on("error",a=>{this.wolError.emit(a)}),e.featuresloadend=n.on("featuresloadend",a=>{this.wolFeaturesLoadEnd.emit(a)}),e.featuresloaderror=n.on("featuresloaderror",a=>{this.wolFeaturesLoadError.emit(a)}),e.featuresloadstart=n.on("featuresloadstart",a=>{this.wolFeaturesLoadStart.emit(a)}),e.propertychange=n.on("propertychange",a=>{this.wolPropertyChange.emit(a)}),e.removefeature=n.on("removefeature",a=>{this.wolRemoveFeature.emit(a)}),Promise.resolve().then(()=>{o=r.setSource(n)}),this.vectorSourceInstance.set(n)}),t.onDestroy(()=>{b(Object.values(e)),o&&o(),this.vectorSourceInstance.set(void 0)})}ngOnChanges(t){let r=this.vectorSourceInstance();if(r)for(let[e,o]of Object.entries(t))switch(e){case"wolAttributions":r.setAttributions(o.currentValue);break;case"wolLoader":r.setLoader(o.currentValue);break;case"wolProperties":r.setProperties(o.currentValue??{});break;case"wolUrl":r.setUrl(o.currentValue);break}}getInstance(){return this.vectorSourceInstance()}static \u0275fac=function(r){return new(r||u)};static \u0275cmp=p({type:u,selectors:[["wol-vector-source"]],inputs:{wolAttributions:[1,"wolAttributions"],wolFeatures:[1,"wolFeatures"],wolFormat:[1,"wolFormat"],wolLoader:[1,"wolLoader"],wolOverlaps:[1,"wolOverlaps"],wolStrategy:[1,"wolStrategy"],wolUrl:[1,"wolUrl"],wolUseSpatialIndex:[1,"wolUseSpatialIndex"],wolWrapX:[1,"wolWrapX"],wolProperties:[1,"wolProperties"]},outputs:{wolAddFeature:"wolAddFeature",wolChange:"wolChange",wolChangeFeature:"wolChangeFeature",wolClear:"wolClear",wolError:"wolError",wolFeaturesLoadEnd:"wolFeaturesLoadEnd",wolFeaturesLoadError:"wolFeaturesLoadError",wolFeaturesLoadStart:"wolFeaturesLoadStart",wolPropertyChange:"wolPropertyChange",wolRemoveFeature:"wolRemoveFeature"},exportAs:["wolVectorSource"],features:[w],ngContentSelectors:dt,decls:1,vars:0,template:function(r,e){r&1&&(f(),y(0))},encapsulation:2,changeDetection:0})};var rt=class u{static \u0275fac=function(r){return new(r||u)};static \u0275mod=se({type:u});static \u0275inj=ae({})};export{U as a,Z as b,H as c,K as d,z as e,ot as f,rt as g};
