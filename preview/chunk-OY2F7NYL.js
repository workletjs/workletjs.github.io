import{a as tt}from"./chunk-NPZDMHSK.js";import{e as bt,f as vt,g as Ut,h as Gt,i as Mt}from"./chunk-AH5QVOVD.js";import{c as Z,d as st,e as Dt,f as Pt}from"./chunk-BWB3QUPT.js";import{Ac as At,Bc as pt,Cc as $,F as mt,Hc as Ft,J as F,Jc as Lt,Pc as St,Ta as lt,a as k,o as dt,s as Tt,u as at,z as q,zb as Q,zc as Rt}from"./chunk-BTDYMGX4.js";import{m as xt,u as J}from"./chunk-XVBTN5DM.js";import{B as V,C as H,D as ot,F as W,N as _t,O as nt,j as Et,q as ht,u as it}from"./chunk-WEL5MCWD.js";var Zt=`
  attribute vec4 a_position;
  attribute vec4 a_texcoord;

  uniform mat4 u_matrix;
  uniform mat4 u_textureMatrix;

  varying vec2 v_texcoord;

  void main() {
    gl_Position = u_matrix * a_position;
    vec2 texcoord = (u_textureMatrix * a_texcoord).xy;
    v_texcoord = texcoord;
  }
`,Vt=`
  precision mediump float;

  varying vec2 v_texcoord;

  uniform sampler2D u_texture;

  void main() {
    if (
      v_texcoord.x < 0.0 ||
      v_texcoord.y < 0.0 ||
      v_texcoord.x > 1.0 ||
      v_texcoord.y > 1.0
    ) {
      discard;
    }
    gl_FragColor = texture2D(u_texture, v_texcoord);
  }
`,et=class{constructor(e){this.gl_=e,this.program_=rt(e,Vt,Zt),this.positionLocation=e.getAttribLocation(this.program_,"a_position"),this.texcoordLocation=e.getAttribLocation(this.program_,"a_texcoord"),this.matrixLocation=e.getUniformLocation(this.program_,"u_matrix"),this.textureMatrixLocation=e.getUniformLocation(this.program_,"u_textureMatrix"),this.textureLocation=e.getUniformLocation(this.program_,"u_texture"),this.positionBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.positionBuffer),this.positions=[0,0,0,1,1,0,1,0,0,1,1,1],e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.positions),e.STATIC_DRAW),this.texcoordBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,this.texcoordBuffer),this.texcoords=[0,0,0,1,1,0,1,0,0,1,1,1],e.bufferData(e.ARRAY_BUFFER,new Float32Array(this.texcoords),e.STATIC_DRAW)}drawImage(e,o,i,n,a,R,s,x,v,M,S,h,d){let r=this.gl_;x===void 0&&(x=n),v===void 0&&(v=a),R===void 0&&(R=o),s===void 0&&(s=i),M===void 0&&(M=R),S===void 0&&(S=s),h===void 0&&(h=r.canvas.width),d===void 0&&(d=r.canvas.height),r.bindTexture(r.TEXTURE_2D,e),r.useProgram(this.program_),r.bindBuffer(r.ARRAY_BUFFER,this.positionBuffer),r.enableVertexAttribArray(this.positionLocation),r.vertexAttribPointer(this.positionLocation,2,r.FLOAT,!1,0,0),r.bindBuffer(r.ARRAY_BUFFER,this.texcoordBuffer),r.enableVertexAttribArray(this.texcoordLocation),r.vertexAttribPointer(this.texcoordLocation,2,r.FLOAT,!1,0,0);let u=Z(0,h,0,d,-1,1);u=Dt(u,x,v,0),u=st(u,M,S,1),r.uniformMatrix4fv(this.matrixLocation,!1,u);let L=Pt(n/o,a/i,0);L=st(L,R/o,s/i,1),r.uniformMatrix4fv(this.textureMatrixLocation,!1,L),r.uniform1i(this.textureLocation,0),r.drawArrays(r.TRIANGLES,0,this.positions.length/2)}};function yt(t,e,o){let i=t.createShader(e);if(i===null)throw new Error("Shader compilation failed");if(t.shaderSource(i,o),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){let n=t.getShaderInfoLog(i);throw n===null?new Error("Shader info log creation failed"):new Error(n)}return i}function rt(t,e,o){let i=t.createProgram(),n=yt(t,t.VERTEX_SHADER,o),a=yt(t,t.FRAGMENT_SHADER,e);if(i===null)throw new Error("Program creation failed");if(t.attachShader(i,n),t.attachShader(i,a),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS))throw t.getProgramInfoLog(i)===null?new Error("Program info log creation failed"):new Error;return i}var kt=`
  attribute vec4 a_position;

  uniform mat4 u_matrix;

  void main() {
     gl_Position = u_matrix * a_position;
  }
`,qt=`
  precision mediump float;

  uniform vec4 u_val;
  void main() {
     gl_FragColor = u_val;
  }
`,Jt=`
  attribute vec4 a_position;
  attribute vec2 a_texcoord;

  varying vec2 v_texcoord;

  uniform mat4 u_matrix;

  void main() {
     gl_Position = u_matrix * a_position;
     v_texcoord = a_texcoord;
  }
`,Qt=`
  precision mediump float;

  varying vec2 v_texcoord;

  uniform sampler2D u_texture;

  void main() {
    if (v_texcoord.x < 0.0 || v_texcoord.x > 1.0 || v_texcoord.y < 0.0 || v_texcoord.y > 1.0) {
      discard;
    }
    gl_FragColor = texture2D(u_texture, v_texcoord);
  }
`;function Ct(t,e,o,i){let n;return o&&o.length?n=o.shift():mt?n=new OffscreenCanvas(t||300,e||300):n=document.createElement("canvas"),t&&(n.width=t),e&&(n.height=e),n.getContext("webgl",i)}function wt(t){let e=t.canvas;e.width=1,e.height=1,t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT)}var ct=[];function It(t,e,o,i,n,a,R,s,x,v,M,S,h,d){let r=Math.round(i*e),u=Math.round(i*o);t.canvas.width=r,t.canvas.height=u;let L,A;if(A=t.createTexture(),t.bindTexture(t.TEXTURE_2D,A),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),h?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,r,u,0,t.RGBA,M,null),L=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,L),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,A,0),L===null)throw new Error("Could not create framebuffer");if(A===null)throw new Error("Could not create texture");if(x.length===0)return{width:r,height:u,framebuffer:L,texture:A};let T=Et();x.forEach(function(c,D,E){ht(T,c.extent)});let O,_,f,U=1/n;if(!d||x.length!==1||v!==0){if(O=t.createTexture(),A===null)throw new Error("Could not create texture");_=Math.round(W(T)*U),f=Math.round(V(T)*U);let c=t.getParameter(t.MAX_TEXTURE_SIZE),D=Math.max(_,f),E=D>c?c/D:1,l=Math.round(_*E),G=Math.round(f*E);t.bindTexture(t.TEXTURE_2D,O),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),h?(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,l,G,0,t.RGBA,M,null);let p=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,p),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,O,0);let I=new et(t);x.forEach(function(m,B,y){let P=(m.extent[0]-T[0])*U*E,X=-(m.extent[3]-T[3])*U*E,j=W(m.extent)*U*E,b=V(m.extent)*U*E;if(t.bindFramebuffer(t.FRAMEBUFFER,p),t.viewport(0,0,l,G),m.clipExtent){let g=(m.clipExtent[0]-T[0])*U*E,N=-(m.clipExtent[3]-T[3])*U*E,Y=W(m.clipExtent)*U*E,K=V(m.clipExtent)*U*E;t.enable(t.SCISSOR_TEST),t.scissor(h?g:Math.round(g),h?N:Math.round(N),h?Y:Math.round(g+Y)-Math.round(g),h?K:Math.round(N+K)-Math.round(N))}I.drawImage(m.texture,m.width,m.height,v,v,m.width-2*v,m.height-2*v,h?P:Math.round(P),h?X:Math.round(X),h?j:Math.round(P+j)-Math.round(P),h?b:Math.round(X+b)-Math.round(X),l,G),t.disable(t.SCISSOR_TEST)}),t.deleteFramebuffer(p)}else O=x[0].texture,_=x[0].width,f=x[0].width;let C=ot(R),w=ot(T),z=c=>{let D=(c[0][0]-C[0])/a*i,E=-(c[0][1]-C[1])/a*i,l=(c[1][0]-C[0])/a*i,G=-(c[1][1]-C[1])/a*i,p=(c[2][0]-C[0])/a*i,I=-(c[2][1]-C[1])/a*i;return{u1:l,v1:G,u0:D,v0:E,u2:p,v2:I}};t.bindFramebuffer(t.FRAMEBUFFER,L),t.viewport(0,0,r,u);{let c=[],D=[],E=rt(t,Qt,Jt);t.useProgram(E);let l=t.getUniformLocation(E,"u_texture");t.bindTexture(t.TEXTURE_2D,O),t.uniform1i(l,0),s.getTriangles().forEach(function(P,X,j){let b=P.source,g=P.target,{u1:N,v1:Y,u0:K,v0:Bt,u2:Ot,v2:gt}=z(g),jt=(b[0][0]-w[0])/n/_,Nt=-(b[0][1]-w[1])/n/f,zt=(b[1][0]-w[0])/n/_,Yt=-(b[1][1]-w[1])/n/f,Kt=(b[2][0]-w[0])/n/_,Wt=-(b[2][1]-w[1])/n/f;c.push(N,Y,K,Bt,Ot,gt),D.push(zt,Yt,jt,Nt,Kt,Wt)});let G=Z(0,r,u,0,-1,1),p=t.getUniformLocation(E,"u_matrix");t.uniformMatrix4fv(p,!1,G);let I=t.getAttribLocation(E,"a_position"),m=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,m),t.bufferData(t.ARRAY_BUFFER,new Float32Array(c),t.STATIC_DRAW),t.vertexAttribPointer(I,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(I);let B=t.getAttribLocation(E,"a_texcoord"),y=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,y),t.bufferData(t.ARRAY_BUFFER,new Float32Array(D),t.STATIC_DRAW),t.vertexAttribPointer(B,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(B),t.drawArrays(t.TRIANGLES,0,c.length/2)}if(S){let c=rt(t,qt,kt);t.useProgram(c);let D=Z(0,r,u,0,-1,1),E=t.getUniformLocation(c,"u_matrix");t.uniformMatrix4fv(E,!1,D);let l=Array.isArray(S)?S:[0,0,0,255],G=t.getUniformLocation(c,"u_val");!0?t.uniform4fv(G,l):t.uniform4iv(G,l);let I=t.getAttribLocation(c,"a_position"),m=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,m),t.vertexAttribPointer(I,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(I);let B=s.getTriangles().reduce(function(y,P){let X=P.target,{u1:j,v1:b,u0:g,v0:N,u2:Y,v2:K}=z(X);return y.concat([j,b,g,N,g,N,Y,K,Y,K,j,b])},[]);t.bufferData(t.ARRAY_BUFFER,new Float32Array(B),t.STATIC_DRAW),t.drawArrays(t.LINES,0,B.length/2)}return{width:r,height:u,framebuffer:L,texture:A}}var ut=class extends ${constructor(e){super({tileCoord:e.tileCoord,loader:()=>Promise.resolve(new Uint8ClampedArray(4)),interpolate:e.interpolate,transition:e.transition}),this.renderEdges_=e.renderEdges!==void 0?e.renderEdges:!1,this.pixelRatio_=e.pixelRatio,this.gutter_=e.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=e.sourceTileGrid,this.targetTileGrid_=e.targetTileGrid,this.wrappedTileCoord_=e.wrappedTileCoord||e.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;let o=e.sourceProj,i=o.getExtent(),n=e.sourceTileGrid.getExtent();this.clipExtent_=o.canWrapX()?n?H(i,n):i:n;let a=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),R=this.targetTileGrid_.getExtent(),s=this.sourceTileGrid_.getExtent(),x=R?H(a,R):a;if(it(x)===0){this.state=F.EMPTY;return}i&&(s?s=H(s,i):s=i);let v=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),M=e.targetProj,S=Ft(o,M,x,v);if(!isFinite(S)||S<=0){this.state=F.EMPTY;return}let h=e.errorThreshold!==void 0?e.errorThreshold:.5;if(this.triangulation_=new Lt(o,M,x,s,S*h,v,e.transformMatrix),this.triangulation_.getTriangles().length===0){this.state=F.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(S);let d=this.triangulation_.calculateSourceExtent();if(s&&(o.canWrapX()?(d[1]=nt(d[1],s[1],s[3]),d[3]=nt(d[3],s[1],s[3])):d=H(d,s)),!it(d))this.state=F.EMPTY;else{let r=0,u=0;o.canWrapX()&&(r=W(i),u=Math.floor((d[0]-i[0])/r)),_t(d.slice(),o,!0).forEach(A=>{let T=this.sourceTileGrid_.getTileRangeForExtentAndZ(A,this.sourceZ_),O=e.getTileFunction;for(let _=T.minX;_<=T.maxX;_++)for(let f=T.minY;f<=T.maxY;f++){let U=O(this.sourceZ_,_,f,this.pixelRatio_);if(U){let C=u*r;this.sourceTiles_.push({tile:U,offset:C})}}++u}),this.sourceTiles_.length===0&&(this.state=F.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){let e=[],o=!1;if(this.sourceTiles_.forEach(_=>{let f=_.tile;if(!f||f.getState()!==F.LOADED)return;let U=f.getSize(),C=this.gutter_,w,z=At(f.getData());z?w=z:(o=!0,w=pt(Rt(f.getData())));let c=[U[0]+2*C,U[1]+2*C],D=w instanceof Float32Array,E=c[0]*c[1],l=D?Float32Array:Uint8ClampedArray,G=new l(w.buffer),p=l.BYTES_PER_ELEMENT,I=p*G.length/E,m=G.byteLength/c[1],B=Math.floor(m/p/c[0]),y=this.sourceTileGrid_.getTileCoordExtent(f.tileCoord);y[0]+=_.offset,y[2]+=_.offset;let P=this.clipExtent_?.slice();P&&(P[0]+=_.offset,P[2]+=_.offset),e.push({extent:y,clipExtent:P,data:G,dataType:l,bytesPerPixel:I,pixelSize:c,bandCount:B})}),this.sourceTiles_.length=0,e.length===0){this.state=F.ERROR,this.changed();return}let i=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(i),a=typeof n=="number"?n:n[0],R=typeof n=="number"?n:n[1],s=Math.round(a*this.pixelRatio_),x=Math.round(R*this.pixelRatio_),v=this.targetTileGrid_.getResolution(i),M=this.sourceTileGrid_.getResolution(this.sourceZ_),S=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),h=e[0].bandCount,d=new e[0].dataType(h*s*x),r=Ct(s,x,ct,{premultipliedAlpha:!1,antialias:!1}),u,L=r.RGBA,A;e[0].dataType==Float32Array?(A=r.FLOAT,r.getExtension("WEBGL_color_buffer_float"),r.getExtension("OES_texture_float"),r.getExtension("EXT_float_blend"),u=r.getExtension("OES_texture_float_linear")!==null&&this.interpolate):(A=r.UNSIGNED_BYTE,u=this.interpolate);let T=4,O=Math.ceil(h/T);for(let _=O-1;_>=0;--_){let f=[];for(let l=0,G=e.length;l<G;++l){let p=e[l],I=p.pixelSize,m=I[0],B=I[1],y=new p.dataType(T*m*B),P=p.data,X=_*T;for(let b=0,g=y.length;b<g;b+=T)y[b]=P[X],y[b+1]=P[X+1],y[b+2]=P[X+2],y[b+3]=P[X+3],X+=h;let j=r.createTexture();r.bindTexture(r.TEXTURE_2D,j),u?(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR)):(r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST)),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texImage2D(r.TEXTURE_2D,0,L,m,B,0,L,A,y),f.push({extent:p.extent,clipExtent:p.clipExtent,texture:j,width:m,height:B})}let{framebuffer:U,width:C,height:w}=It(r,a,R,this.pixelRatio_,M,v,S,this.triangulation_,f,this.gutter_,A,this.renderEdges_,u),z=C,c=w*T,D=new e[0].dataType(z*c);r.bindFramebuffer(r.FRAMEBUFFER,U),r.readPixels(0,0,C,w,r.RGBA,A,D);let E=_*T;for(let l=0,G=D.length;l<G;l+=T){let p=(z-1-(l/c|0))*c+l%c;d[E]=D[p],d[E+1]=D[p+1],d[E+2]=D[p+2],d[E+3]=D[p+3],E+=h}}if(wt(r),ct.push(r.canvas),o){let _=lt(a,R),f=new ImageData(d,a);_.putImageData(f,0,0),this.reprojData_=_.canvas}else this.reprojData_=d;this.reprojSize_=[s,x],this.state=F.LOADED,this.changed()}load(){if(this.state!==F.IDLE&&this.state!==F.ERROR)return;this.state=F.LOADING,this.changed();let e=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:o})=>{let i=o.getState();if(i!==F.IDLE&&i!==F.LOADING)return;e++;let n=Tt(o,k.CHANGE,()=>{let a=o.getState();(a==F.LOADED||a==F.ERROR||a==F.EMPTY)&&(at(n),e--,e===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(n)}),e===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:o}){o.getState()==F.IDLE&&o.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(at),this.sourcesListenerKeys_=null}},Xt=ut;var ft=class extends Mt{constructor(e){let o=e.projection===void 0?"EPSG:3857":e.projection,i=e.tileGrid;i===void 0&&o&&(i=vt({extent:Ut(o),maxResolution:e.maxResolution,maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize})),super({cacheSize:.1,attributions:e.attributions,attributionsCollapsible:e.attributionsCollapsible,projection:o,tileGrid:i,state:e.state,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,zDirection:e.zDirection}),this.gutter_=e.gutter!==void 0?e.gutter:0,this.tileSize_=e.tileSize?Q(e.tileSize):null,this.tileSizes_=null,this.tileLoadingKeys_={},this.loader_=e.loader,this.handleTileChange_=this.handleTileChange_.bind(this),this.bandCount=e.bandCount===void 0?4:e.bandCount,this.tileGridForProjection_={},this.crossOrigin_=e.crossOrigin||"anonymous",this.transformMatrix=null}setTileSizes(e){this.tileSizes_=e}getTileSize(e){if(this.tileSizes_)return this.tileSizes_[e];if(this.tileSize_)return this.tileSize_;let o=this.getTileGrid();return o?Q(o.getTileSize(e)):[256,256]}getGutterForProjection(e){let o=this.getProjection();return(!o||J(o,e))&&!this.transformMatrix?this.gutter_:0}setLoader(e){this.loader_=e}getReprojTile_(e,o,i,n,a,R){let s=this.tileGrid||this.getTileGridForProjection(a||n),x=Math.max.apply(null,s.getResolutions().map((r,u)=>{let L=Q(s.getTileSize(u)),A=this.getTileSize(u);return Math.max(A[0]/L[0],A[1]/L[1])})),v=this.getTileGridForProjection(n),M=[e,o,i],S=this.getTileCoordForTileUrlFunction(M,n),h=Object.assign({sourceProj:a||n,sourceTileGrid:s,targetProj:n,targetTileGrid:v,tileCoord:M,wrappedTileCoord:S,pixelRatio:x,gutter:this.gutter_,getTileFunction:(r,u,L,A)=>this.getTile(r,u,L,A,void 0,R),transformMatrix:this.transformMatrix},this.tileOptions),d=new Xt(h);return d.key=this.getKey(),d}getTile(e,o,i,n,a,R){let s=this.getProjection();if(a&&(s&&!J(s,a)||this.transformMatrix))return this.getReprojTile_(e,o,i,a,s,R);let x=this.getTileSize(e),v=this.loader_,M=new AbortController,S={signal:M.signal,crossOrigin:this.crossOrigin_},h=this.getTileCoordForTileUrlFunction([e,o,i]);if(!h)return null;let d=this.getKey(),r=St(this,d,e,o,i);if(R&&R.containsKey(r))return R.get(r);let u=h[0],L=h[1],A=h[2],T=this.getTileGrid()?.getFullTileRange(u);T&&(S.maxY=T.getHeight()-1);function O(){return dt(function(){return v(u,L,A,S)})}let _=Object.assign({tileCoord:[e,o,i],loader:O,size:x,controller:M},this.tileOptions),f=new $(_);return f.key=this.getKey(),f.addEventListener(k.CHANGE,this.handleTileChange_),R?.set(r,f),f}handleTileChange_(e){let o=e.target,i=q(o),n=o.getState(),a;n==F.LOADING?(this.tileLoadingKeys_[i]=!0,a=tt.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],a=n==F.ERROR?tt.TILELOADERROR:n==F.LOADED?tt.TILELOADEND:void 0),a&&this.dispatchEvent(new Gt(a,o))}getTileGridForProjection(e){let o=this.getProjection();if(this.tileGrid&&(!o||J(o,e))&&!this.transformMatrix)return this.tileGrid;let i=q(e);return i in this.tileGridForProjection_||(this.tileGridForProjection_[i]=bt(e)),this.tileGridForProjection_[i]}setTileGridForProjection(e,o){let i=xt(e);if(i){let n=q(i);n in this.tileGridForProjection_||(this.tileGridForProjection_[n]=o)}}},ve=ft;export{ve as a};
