import{Lb as h,xb as i}from"./chunk-IV3CZHWS.js";var a=class extends h{constructor(e){let t=e||{};super(t),t.stopDown&&(this.stopDown=t.stopDown),this.scaleDeltaByPixel_=t.delta?t.delta:.01,this.duration_=t.duration!==void 0?t.duration:250,this.handlingDownUpSequence_=!1,this.handlingDoubleDownSequence_=!1,this.doubleTapTimeoutId_=void 0,this.trackedPointers_={},this.down_=null,this.targetPointers=[]}handleEvent(e){if(!e.originalEvent)return!0;let t=!1;if(this.updateTrackedPointers_(e),this.handlingDownUpSequence_){if(e.type==i.POINTERDRAG)this.handleDragEvent(e),e.originalEvent.preventDefault();else if(e.type==i.POINTERUP){let n=this.handleUpEvent(e);this.handlingDownUpSequence_=n}}else if(e.type==i.POINTERDOWN)if(this.handlingDoubleDownSequence_){this.handlingDoubleDownSequence_=!1;let n=this.handleDownEvent(e);this.handlingDownUpSequence_=n,t=this.stopDown(n)}else t=this.stopDown(!1),this.waitForDblTap_();return!t}handleDragEvent(e){let t=1,n=this.targetPointers[0],s=this.down_,l=n.clientY-s.clientY;this.lastDistance_!==void 0&&(t=1-(this.lastDistance_-l)*this.scaleDeltaByPixel_),this.lastDistance_=l,t!=1&&(this.lastScaleDelta_=t);let d=e.map,u=d.getView();d.render(),u.adjustResolutionInternal(t)}handleDownEvent(e){if(this.targetPointers.length==1){let t=e.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.down_=e.originalEvent,this.handlingDownUpSequence_||t.getView().beginInteraction(),!0}return!1}handleUpEvent(e){if(this.targetPointers.length==0){let n=e.map.getView(),s=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,s),this.handlingDownUpSequence_=!1,this.handlingDoubleDownSequence_=!1,!1}return!0}stopDown(e){return e}updateTrackedPointers_(e){if(c(e)){let t=e.originalEvent,n=t.pointerId.toString();e.type==i.POINTERUP?delete this.trackedPointers_[n]:e.type==i.POINTERDOWN?this.trackedPointers_[n]=t:n in this.trackedPointers_&&(this.trackedPointers_[n]=t),this.targetPointers=Object.values(this.trackedPointers_)}}waitForDblTap_(){this.doubleTapTimeoutId_!==void 0?(clearTimeout(this.doubleTapTimeoutId_),this.doubleTapTimeoutId_=void 0):(this.handlingDoubleDownSequence_=!0,this.doubleTapTimeoutId_=setTimeout(this.endInteraction_.bind(this),250))}endInteraction_(){this.handlingDoubleDownSequence_=!1,this.doubleTapTimeoutId_=void 0}};function c(o){let e=o.type;return e===i.POINTERDOWN||e===i.POINTERDRAG||e===i.POINTERUP}var _=a;export{_ as a};
