import{c as E,d as I,e as O}from"./chunk-JVGRS5FI.js";import{a as f}from"./chunk-XQZMJF3D.js";import{N as h}from"./chunk-IV3CZHWS.js";import{B as m,F as o,x as _}from"./chunk-WEL5MCWD.js";function y(r,e,i,s){let a=o(r),n=m(r),c=e[0],t=e[1],d=.0254/s;return t*a>c*n?a*i/(c*d):n*i/(t*d)}function v(r,e,i,s,a,n,c){let t=y(i,s,n,c),d=_(i),u={OPERATION:a?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:c,SETDISPLAYWIDTH:Math.round(s[0]),SETDISPLAYHEIGHT:Math.round(s[1]),SETVIEWSCALE:t,SETVIEWCENTERX:d[0],SETVIEWCENTERY:d[1]};return Object.assign(u,e),f(r,u)}function P(r){let e=r.load||h,i=r.useOverlay??!1,s=r.metersPerUnit||1,a=r.displayDpi||96,n=r.ratio??1,c=r.crossOrigin??null;return function(t,d,u){let l=new Image;l.crossOrigin=c,t=I(t,d,u,n);let L=o(t)/d,T=m(t)/d,A=[L*u,T*u],S=v(r.url,r.params,t,A,i,s,a);return e(l,S).then(p=>({image:p,extent:t,pixelRatio:u}))}}var g=class extends O{constructor(e){super({interpolate:e.interpolate,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=e.crossOrigin!==void 0?e.crossOrigin:null,this.displayDpi_=e.displayDpi!==void 0?e.displayDpi:96,this.params_=Object.assign({},e.params),this.url_=e.url,this.imageLoadFunction_=e.imageLoadFunction!==void 0?e.imageLoadFunction:E,this.hidpi_=e.hidpi!==void 0?e.hidpi:!0,this.metersPerUnit_=e.metersPerUnit!==void 0?e.metersPerUnit:1,this.ratio_=e.ratio!==void 0?e.ratio:1,this.useOverlay_=e.useOverlay!==void 0?e.useOverlay:!1,this.renderedRevision_=0,this.loaderProjection_=null}getParams(){return this.params_}getImageInternal(e,i,s,a){return this.url_===void 0?null:((!this.loader||this.loaderProjection_!==a)&&(this.loaderProjection_=a,this.loader=P({crossOrigin:this.crossOrigin_,params:this.params_,hidpi:this.hidpi_,metersPerUnit:this.metersPerUnit_,url:this.url_,useOverlay:this.useOverlay_,ratio:this.ratio_,load:(n,c)=>(this.image.setImage(n),this.imageLoadFunction_(this.image,c),h(n))})),super.getImageInternal(e,i,s,a))}getImageLoadFunction(){return this.imageLoadFunction_}setParams(e){this.params_=Object.assign({},e),this.changed()}updateParams(e){Object.assign(this.params_,e),this.changed()}setImageLoadFunction(e){this.imageLoadFunction_=e,this.changed()}changed(){this.image=null,super.changed()}},G=g;export{G as a};
