import{a as E}from"./chunk-OTJHMR35.js";import{a as S}from"./chunk-AN4HRE37.js";import{a as f}from"./chunk-YVF6ZWVF.js";import{f as u,g as m}from"./chunk-7JSZMF5L.js";import{m as o,v as d}from"./chunk-AKEHF7AE.js";import{G as h,L as c}from"./chunk-O23OEJHM.js";var s=class extends S{constructor(e){if(super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:o("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.tileJSON_=null,this.tileSize_=e.tileSize,e.url)if(e.jsonp)E(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{let t=new XMLHttpRequest;t.addEventListener("load",this.onXHRLoad_.bind(this)),t.addEventListener("error",this.onXHRError_.bind(this)),t.open("GET",e.url),t.send()}else if(e.tileJSON)this.handleTileJSONResponse(e.tileJSON);else throw new Error("Either `url` or `tileJSON` options must be provided")}onXHRLoad_(e){let t=e.target;if(!t.status||t.status>=200&&t.status<300){let r;try{r=JSON.parse(t.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(r)}else this.handleTileJSONError()}onXHRError_(e){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(e){let t=o("EPSG:4326"),r=this.getProjection(),i;if(e.bounds!==void 0){let n=d(t,r);i=c(e.bounds,n)}let a=m(r),p=e.minzoom||0,T=e.maxzoom||22,l=u({extent:a,maxZoom:T,minZoom:p,tileSize:this.tileSize_});if(this.tileGrid=l,this.tileUrlFunction=f(e.tiles,l),e.attribution&&!this.getAttributions()){let n=i!==void 0?i:a;this.setAttributions(function(b){return h(n,b.extent)?[e.attribution]:null})}this.tileJSON_=e,this.setState("ready")}handleTileJSONError(){this.setState("error")}},P=s;export{P as a};
