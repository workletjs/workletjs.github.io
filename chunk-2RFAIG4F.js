import{b as x,d as b}from"./chunk-WU7HYRQH.js";import{h as f}from"./chunk-H4Z7ACEM.js";import{Ea as L,Ha as E,Ia as R,a as U,k as d,ka as y,p as c,pa as P,ua as G}from"./chunk-6XVVBGJF.js";import{l as p,t as g}from"./chunk-JDAOPQSJ.js";import{P as j}from"./chunk-5N5AZK4V.js";function k(l,e){return(function(t,i,r){if(!t)return;let n,o=t[0];if(e){let s=e.getFullTileRange(o);s&&(n=s.getHeight()-1)}return x(l,o,t[1],t[2],n)})}function C(l,e){let t=l.length,i=new Array(t);for(let r=0;r<t;++r)i[r]=k(l[r],e);return w(i)}function w(l){return l.length===1?l[0]:(function(e,t,i){if(!e)return;let r=G(e),n=j(r,l.length);return l[n](e,t,i)})}function H(l,e,t){}var T=class l extends R{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tilePixelRatio:e.tilePixelRatio,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===l.prototype.tileUrlFunction,this.tileLoadFunction=e.tileLoadFunction,e.tileUrlFunction&&(this.tileUrlFunction=e.tileUrlFunction),this.urls=null,e.urls?this.setUrls(e.urls):e.url&&this.setUrl(e.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(e){let t=e.target,i=d(t),r=t.getState(),n;r==c.LOADING?(this.tileLoadingKeys_[i]=!0,n=f.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],n=r==c.ERROR?f.TILELOADERROR:r==c.LOADED?f.TILELOADEND:void 0),n!=null&&this.dispatchEvent(new E(n,t))}setTileLoadFunction(e){this.tileLoadFunction=e,this.changed()}setTileUrlFunction(e,t){this.tileUrlFunction=e,typeof t<"u"?this.setKey(t):this.changed()}setUrl(e){let t=b(e);this.urls=t,this.setUrls(t)}setUrls(e){this.urls=e;let t=e.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(C(e,this.tileGrid),t):this.setKey(t)}tileUrlFunction(e,t,i){}},O=T;var F=class extends O{constructor(e){super({attributions:e.attributions,cacheSize:e.cacheSize,projection:e.projection,state:e.state,tileGrid:e.tileGrid,tileLoadFunction:e.tileLoadFunction?e.tileLoadFunction:z,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:e.wrapX,transition:e.transition,interpolate:e.interpolate!==void 0?e.interpolate:!0,key:e.key,attributionsCollapsible:e.attributionsCollapsible,zDirection:e.zDirection}),this.crossOrigin=e.crossOrigin!==void 0?e.crossOrigin:null,this.tileClass=e.tileClass!==void 0?e.tileClass:y,this.tileGridForProjection={},this.reprojectionErrorThreshold_=e.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(e){return this.getProjection()&&e&&!g(this.getProjection(),e)?0:this.getGutter()}getGutter(){return 0}getKey(){let e=super.getKey();return this.getInterpolate()||(e+=":disable-interpolation"),e}getTileGridForProjection(e){let t=this.getProjection();if(this.tileGrid&&(!t||g(t,e)))return this.tileGrid;let i=d(e);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=L(e)),this.tileGridForProjection[i]}createTile_(e,t,i,r,n,o){let s=[e,t,i],h=this.getTileCoordForTileUrlFunction(s,n),u=h?this.tileUrlFunction(h,r,n):void 0,a=new this.tileClass(s,u!==void 0?c.IDLE:c.EMPTY,u!==void 0?u:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return a.key=o,a.addEventListener(U.CHANGE,this.handleTileChange.bind(this)),a}getTile(e,t,i,r,n){let o=this.getProjection();if(!o||!n||g(o,n))return this.getTileInternal(e,t,i,r,o||n);let s=[e,t,i],h=this.getKey(),u=this.getTileGridForProjection(o),a=this.getTileGridForProjection(n),_=this.getTileCoordForTileUrlFunction(s,n),m=new P(o,u,n,a,s,_,this.getTilePixelRatio(r),this.getGutter(),(D,K,S,I)=>this.getTileInternal(D,K,S,I,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return m.key=h,m}getTileInternal(e,t,i,r,n){let o=this.getKey();return this.createTile_(e,t,i,r,n,o)}setRenderReprojectionEdges(e){this.renderReprojectionEdges_!=e&&(this.renderReprojectionEdges_=e,this.changed())}setTileGridForProjection(e,t){let i=p(e);if(i){let r=d(i);r in this.tileGridForProjection||(this.tileGridForProjection[r]=t)}}};function z(l,e){l.getImage().src=e}var le=F;export{C as a,w as b,H as c,le as d};
