import{a as P}from"./chunk-BGTTLMCZ.js";import{a as L,d as j}from"./chunk-6AENYVP6.js";import{g as J}from"./chunk-JAHNM7IB.js";import{Ga as C,Ha as D,i as N}from"./chunk-QKVTYPUH.js";import{l as c,u as v}from"./chunk-QQYK7P6A.js";import{Q as y,U as O}from"./chunk-RDGT5TKL.js";import{Aa as T,Ja as S,P as w,S as m,Tb as s,Ub as r,_ as p,ea as g,jb as b,kb as E,za as f}from"./chunk-JM5XIBFZ.js";var u=class extends j{constructor(e){if(super({attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,interpolate:e.interpolate,projection:c("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:"loading",tileLoadFunction:e.tileLoadFunction,wrapX:e.wrapX!==void 0?e.wrapX:!0,transition:e.transition,zDirection:e.zDirection}),this.tileJSON_=null,this.tileSize_=e.tileSize,e.url)if(e.jsonp)P(e.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{let o=new XMLHttpRequest;o.addEventListener("load",this.onXHRLoad_.bind(this)),o.addEventListener("error",this.onXHRError_.bind(this)),o.open("GET",e.url),o.send()}else if(e.tileJSON)this.handleTileJSONResponse(e.tileJSON);else throw new Error("Either `url` or `tileJSON` options must be provided")}onXHRLoad_(e){let o=e.target;if(!o.status||o.status>=200&&o.status<300){let t;try{t=JSON.parse(o.responseText)}catch{this.handleTileJSONError();return}this.handleTileJSONResponse(t)}else this.handleTileJSONError()}onXHRError_(e){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(e){let o=c("EPSG:4326"),t=this.getProjection(),l;if(e.bounds!==void 0){let d=v(o,t);l=O(e.bounds,d)}let n=D(t),i=e.minzoom||0,M=e.maxzoom||22,h=C({extent:n,maxZoom:M,minZoom:i,tileSize:this.tileSize_});if(this.tileGrid=h,this.tileUrlFunction=L(e.tiles,h),e.attribution&&!this.getAttributions()){let d=l!==void 0?l:n;this.setAttributions(function(x){return y(d,x.extent)?[e.attribution]:null})}this.tileJSON_=e,this.setState("ready")}handleTileJSONError(){this.setState("error")}},z=u;var W=["*"],R=class a{wolAttributions=r();wolCacheSize=r();wolCrossOrigin=r();wolInterpolate=r();wolJsonp=r();wolReprojectionErrorThreshold=r();wolTileJSON=r();wolTileLoadFunction=r();wolTileSize=r();wolUrl=r();wolWrapX=r();wolTransition=r();wolZDirection=r();wolProperties=r();wolChange=s();wolError=s();wolPropertyChange=s();wolTileLoadEnd=s();wolTileLoadError=s();wolTileLoadStart=s();instance;constructor(){let e=m(p),o=J("TileJSON"),t={},l;S(()=>{let n=new z({attributions:this.wolAttributions(),cacheSize:this.wolCacheSize(),crossOrigin:this.wolCrossOrigin(),interpolate:this.wolInterpolate(),jsonp:this.wolJsonp(),reprojectionErrorThreshold:this.wolReprojectionErrorThreshold(),tileJSON:this.wolTileJSON(),tileLoadFunction:this.wolTileLoadFunction(),tileSize:this.wolTileSize(),url:this.wolUrl(),wrapX:this.wolWrapX(),transition:this.wolTransition(),zDirection:this.wolZDirection()});this.wolProperties()&&n.setProperties(this.wolProperties(),!0),t.change=n.on("change",i=>this.wolChange.emit(i)),t.error=n.on("error",i=>this.wolError.emit(i)),t.propertychange=n.on("propertychange",i=>this.wolPropertyChange.emit(i)),t.tileloadend=n.on("tileloadend",i=>this.wolTileLoadEnd.emit(i)),t.tileloaderror=n.on("tileloaderror",i=>this.wolTileLoadError.emit(i)),t.tileloadstart=n.on("tileloadstart",i=>this.wolTileLoadStart.emit(i)),Promise.resolve().then(()=>{l=o.setSource(n)}),this.instance=n}),e.onDestroy(()=>{l&&l(),N(Object.values(t)),this.instance=void 0})}ngOnChanges(e){if(this.instance)for(let[o,t]of Object.entries(e))switch(o){case"wolAttributions":this.instance.setAttributions(t.currentValue);break;case"wolProperties":this.instance.setProperties(t.currentValue??{},!1);break;case"wolTileLoadFunction":this.instance.setTileLoadFunction(t.currentValue);break;case"wolUrl":this.instance.setUrl(t.currentValue);break}}getInstance(){return this.instance}static \u0275fac=function(o){return new(o||a)};static \u0275cmp=f({type:a,selectors:[["wol-tile-json-source"]],inputs:{wolAttributions:[1,"wolAttributions"],wolCacheSize:[1,"wolCacheSize"],wolCrossOrigin:[1,"wolCrossOrigin"],wolInterpolate:[1,"wolInterpolate"],wolJsonp:[1,"wolJsonp"],wolReprojectionErrorThreshold:[1,"wolReprojectionErrorThreshold"],wolTileJSON:[1,"wolTileJSON"],wolTileLoadFunction:[1,"wolTileLoadFunction"],wolTileSize:[1,"wolTileSize"],wolUrl:[1,"wolUrl"],wolWrapX:[1,"wolWrapX"],wolTransition:[1,"wolTransition"],wolZDirection:[1,"wolZDirection"],wolProperties:[1,"wolProperties"]},outputs:{wolChange:"wolChange",wolError:"wolError",wolPropertyChange:"wolPropertyChange",wolTileLoadEnd:"wolTileLoadEnd",wolTileLoadError:"wolTileLoadError",wolTileLoadStart:"wolTileLoadStart"},features:[g],ngContentSelectors:W,decls:1,vars:0,template:function(o,t){o&1&&(b(),E(0))},encapsulation:2,changeDetection:0})};var F=class a{static \u0275fac=function(o){return new(o||a)};static \u0275mod=T({type:a});static \u0275inj=w({})};export{R as a,F as b};
