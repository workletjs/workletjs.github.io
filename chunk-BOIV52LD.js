import{a as b,b as w,c as C,d as y}from"./chunk-44KRX5QE.js";import{a as P,g as j}from"./chunk-WYMWOCNO.js";import{U as s,da as m,ea as O,w as a}from"./chunk-MZHSP6VU.js";import{b as G,l as c}from"./chunk-HS6NXQG3.js";var f=class extends b{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(l(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(l(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return a()}readFeaturesFromObject(e,t){return a()}readGeometry(e,t){return this.readGeometryFromObject(l(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return a()}readProjection(e){return this.readProjectionFromObject(l(e))}readProjectionFromObject(e){return a()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return a()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return a()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return a()}};function l(r){if(typeof r=="string"){let e=JSON.parse(r);return e||null}return r!==null?r:null}var S=f;var g=class extends S{constructor(e){e=e||{},super(),this.dataProjection=c(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=c(e.featureProjection)),e.featureClass&&(this.featureClass=e.featureClass),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let o=null;e.type==="Feature"?o=e:o={type:"Feature",geometry:e,properties:null};let n=h(o.geometry,t);if(this.featureClass===j)return C({geometry:n,id:o.id,properties:o.properties},t);let i=new P;return this.geometryName_?i.setGeometryName(this.geometryName_):this.extractGeometryName_&&o.geometry_name&&i.setGeometryName(o.geometry_name),i.setGeometry(y(n,t)),"id"in o&&i.setId(o.id),o.properties&&i.setProperties(o.properties,!0),i}readFeaturesFromObject(e,t){let o=e,n=null;if(o.type==="FeatureCollection"){let i=e;n=[];let u=i.features;for(let d=0,M=u.length;d<M;++d){let F=this.readFeatureFromObject(u[d],t);F&&n.push(F)}}else n=[this.readFeatureFromObject(e,t)];return n.flat()}readGeometryFromObject(e,t){return N(e,t)}readProjectionFromObject(e){let t=e.crs,o;if(t)if(t.type=="name")o=c(t.properties.name);else if(t.type==="EPSG")o=c("EPSG:"+t.properties.code);else throw new Error("Unknown SRS type");else o=this.dataProjection;return o}writeFeatureObject(e,t){t=this.adaptOptions(t);let o={type:"Feature",geometry:null,properties:null},n=e.getId();if(n!==void 0&&(o.id=n),!e.hasProperties())return o;let i=e.getProperties(),u=e.getGeometry();return u&&(o.geometry=p(u,t),delete i[e.getGeometryName()]),G(i)||(o.properties=i),o}writeFeaturesObject(e,t){t=this.adaptOptions(t);let o=[];for(let n=0,i=e.length;n<i;++n)o.push(this.writeFeatureObject(e[n],t));return{type:"FeatureCollection",features:o}}writeGeometryObject(e,t){return p(e,this.adaptOptions(t))}};function h(r,e){if(!r)return null;let t;switch(r.type){case"Point":{t=L(r);break}case"LineString":{t=J(r);break}case"Polygon":{t=R(r);break}case"MultiPoint":{t=E(r);break}case"MultiLineString":{t=x(r);break}case"MultiPolygon":{t=_(r);break}case"GeometryCollection":{t=k(r);break}default:throw new Error("Unsupported GeoJSON type: "+r.type)}return t}function N(r,e){let t=h(r,e);return y(t,e)}function k(r,e){return r.geometries.map(function(o){return h(o,e)})}function L(r){let e=r.coordinates;return{type:"Point",flatCoordinates:e,layout:s(e.length)}}function J(r){let e=r.coordinates,t=e.flat();return{type:"LineString",flatCoordinates:t,ends:[t.length],layout:s(e[0]?.length||2)}}function x(r){let e=r.coordinates,t=e[0]?.[0]?.length||2,o=[],n=m(o,0,e,t);return{type:"MultiLineString",flatCoordinates:o,ends:n,layout:s(t)}}function E(r){let e=r.coordinates;return{type:"MultiPoint",flatCoordinates:e.flat(),layout:s(e[0]?.length||2)}}function _(r){let e=r.coordinates,t=[],o=e[0]?.[0]?.[0].length||2,n=O(t,0,e,o);return{type:"MultiPolygon",flatCoordinates:t,ends:n,layout:s(o)}}function R(r){let e=r.coordinates,t=[],o=e[0]?.[0]?.length,n=m(t,0,e,o);return{type:"Polygon",flatCoordinates:t,ends:n,layout:s(o)}}function p(r,e){r=w(r,!0,e);let t=r.getType(),o;switch(t){case"Point":{o=v(r,e);break}case"LineString":{o=I(r,e);break}case"Polygon":{o=W(r,e);break}case"MultiPoint":{o=U(r,e);break}case"MultiLineString":{o=T(r,e);break}case"MultiPolygon":{o=H(r,e);break}case"GeometryCollection":{o=A(r,e);break}case"Circle":{o={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return o}function A(r,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:r.getGeometriesArray().map(function(o){return p(o,e)})}}function I(r,e){return{type:"LineString",coordinates:r.getCoordinates()}}function T(r,e){return{type:"MultiLineString",coordinates:r.getCoordinates()}}function U(r,e){return{type:"MultiPoint",coordinates:r.getCoordinates()}}function H(r,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:r.getCoordinates(t)}}function v(r,e){return{type:"Point",coordinates:r.getCoordinates()}}function W(r,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:r.getCoordinates(t)}}var ee=g;export{ee as a};
